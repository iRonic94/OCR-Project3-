<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="UTF-8">
	<title>Sophie Bluel - Interior Designer</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Work+Sans&display=swap"
		rel="stylesheet">
	<meta name="description" content="">
	<link rel="stylesheet" href="./assets/style.css">
	<script>
		let allWorks = [];
		let categories = [];
		let activeFilterId = 'all';
		let activeProjects;
		async function getProjects() {
			const url = "http://localhost:5678/api/works";
			const response = await fetch(url);
			const works = await response.json();
			allWorks = works;
			renderGallery(allWorks);
		}
		function renderGallery(works) {
			const gallery = document.querySelector(".gallery");
			activeProjects = [];
			works.forEach(work => {
				const figure = document.createElement("figure");
				const img = document.createElement("img");
				img.src = work.imageUrl;
				img.alt = work.title;

				const figcaption = document.createElement("figcaption");
				figcaption.textContent = work.title;

				figure.appendChild(img);
				figure.appendChild(figcaption);
				activeProjects.push(figure);
				console.log(activeProjects);
			});
			gallery.replaceChildren(...activeProjects);
		}
		async function getFilters() {
			const url = "http://localhost:5678/api/categories";
			try {
				const response = await fetch(url);
				if (!response.ok) {
					throw new Error(`Response status: ${response.status}`);
				}
				const categories = await response.json();
				const filtersContainer = document.getElementById("filters");

				const allBtn = document.createElement("button");
				allBtn.textContent = "All";
				allBtn.classList.add("btn-filter", "active");
				allBtn.setAttribute("id", "all");
				filtersContainer.appendChild(allBtn);
				categories.forEach(category => {
					const button = document.createElement("button");
					button.textContent = category.name;
					button.setAttribute("class", "btn-filter");
					button.setAttribute("id", category.id);
					filtersContainer.appendChild(button);
				})

			} catch (error) {
				console.error(error.message);
			}
			setFilters();
		}
		function setFilters() {
			const buttons = document.querySelectorAll(".btn-filter");

			buttons.forEach(btn => {
				btn.addEventListener("click", () => {
					let activeBtn = document.getElementById(activeFilterId)
					console.log(activeBtn);
					//remove active class
					activeBtn.classList.remove("active");
					//add active class
					btn.classList.add("active");
					//update active id
					activeFilterId = btn.id;
					//first create var to store all projects
					//check all to show all projects
					if (activeFilterId === "all") {
						activeProjects = allWorks;
						console.log(activeProjects);
					} else {
						activeProjects = allWorks.filter(work => work.categoryId === Number(activeFilterId));
					}
					renderGallery(activeProjects);
				});
			});
		}
		document.addEventListener("DOMContentLoaded", () => {
			getProjects();
			getFilters();
		});
	</script>
</head>

<body>

	<header>
		<h1>Sophie Bluel <span>Interior Designer</span></h1>
		<nav>
			<ul>
				<li>projects</li>
				<li>contact</li>
				<li>login</li>
				<li><img src="./assets/icons/instagram.png" alt="Instagram"></li>
			</ul>
		</nav>
	</header>
	<main>
		<section id="introduction">
			<figure>
				<img src="./assets/images/sophie-bluel.png" alt="">
			</figure>
			<article>
				<h2>Space Designer</h2>
				<p>I tell your story and bring your ideas to life. I work with you every step of the way—from the design
					stage until the very end of the project.</p>
				<p>Together, we’ll decide on the volumes, materials, and colors, while maintaining the space’s character
					and selection of materials. Every single aspect of the project will be thoroughly monitored,
					ensuring it remains on schedule and on budget.</p>
				<p>If necessary, a multidisciplinary team can be brought into your project, including an accredited
					architect and a decorator.</p>
			</article>
		</section>
		<section id="portfolio">
			<h2>My Projects</h2>
			<div id="filters"></div>
			<div class="gallery"></div>
		</section>
		<section id="contact">
			<h2>Contact</h2>
			<p>Do you have a project in mind? Let’s talk about it!</p>
			<form action="#" method="post">
				<label for="name">Name</label>
				<input type="text" name="name" id="name">
				<label for="email">Email</label>
				<input type="email" name="email" id="email">
				<label for="message">Message</label>
				<textarea name="message" id="message" cols="30" rows="10"></textarea>
				<input type="submit" value="Send">
			</form>
		</section>
	</main>

	<footer>
		<nav>
			<ul>
				<li>Legal Notice</li>
			</ul>
		</nav>
	</footer>

</body>

</html>